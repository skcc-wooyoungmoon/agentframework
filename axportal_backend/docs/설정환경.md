# 📊 Spring Boot 환경별 설정 비교 분석서

## 📋 문서 정보
- **작성일**: 2025-11-16
- **작성자**: GitHub Copilot
- **프로젝트**: AX Portal Backend
- **Spring Boot**: 3.5.4
- **분석 대상**: application.yml + 환경별 설정 파일 5개

---

## 🏗️ 환경 아키텍처 개요

### **환경 구성도**
```
📁 application*.yml 구조
├── 📄 application.yml (공통 설정)
├── 🟢 application-elocal.yml (외부Local - 기본 프로필)
├── 🔵 application-local.yml (내부Local)
├── 🟡 application-edev.yml (외부개발)
├── 🟠 application-dev.yml (내부개발)
└── 🔴 application-prod.yml (운영환경)
```

### **환경별 용도 및 특성**
| 환경 | 프로필명 | 용도 | 데이터베이스 | 특징 |
|------|----------|------|--------------|------|
| **외부Local** | `elocal` | 개발자 로컬(기본) | PostgreSQL | H2 콘솔, DevTools 활성화 |
| **외부개발** | `edev` | 외부 개발서버 | PostgreSQL | 콘솔+파일 로깅 |
| **내부Local** | `local` | 개발자 로컬 | Tibero | DevTools 활성화 |
| **내부개발** | `dev` | 내부 개발서버 | Tibero | 파일 로깅, 성능테스트 최적화 |
| **운영환경** | `prod` | 실제 운영서버 | Tibero | Swagger 비활성화, 보안 강화 |

---

## 🗃️ 데이터베이스 설정 비교

### **1. 데이터베이스 연결 정보**

| 환경 | RDBMS | 연결 URL | 드라이버 | 특징 |
|------|--------|----------|----------|------|
| **elocal** | PostgreSQL | `axportal-db.cdg6c648ui3x.ap-northeast-2.rds.amazonaws.com:5432` | PostgreSQL | AWS RDS |
| **edev** | PostgreSQL | `axportal-db.cdg6c648ui3x.ap-northeast-2.rds.amazonaws.com:5432` | PostgreSQL | AWS RDS |
| **local** | Tibero | `172.23.238.251:1884:DGAPDB` | TbDriver | 내부 서버 |
| **dev** | Tibero | `172.23.238.251:1884:DGAPDB` | TbDriver | 내부 서버 |
| **prod** | Tibero | `172.23.238.251:1884:DGAPDB` | TbDriver | 내부 서버 |

### **2. 커넥션 풀 설정 비교**

#### **HikariCP 설정 매트릭스**
| 환경 | minimum-idle | maximum-pool-size | connection-timeout | 용도 |
|------|--------------|-------------------|-------------------|------|
| **elocal** | 5 | 10 | 30000ms | 개발용 기본 |
| **edev** | 5 | 10 | 30000ms | 개발용 기본 |
| **local** | 5 | 10 | 30000ms | 개발용 기본 |
| **dev** | 15 ⚡ | 40 ⚡ | 10000ms ⚡ | **성능테스트 최적화** |
| **prod** | 20 🚀 | 60 🚀 | 15000ms 🚀 | **운영환경 대용량** |

> **🎯 성능 최적화 포인트**
> - **dev**: 성능테스트용 연결 풀 확장 (기존 대비 2-4배 증설)
> - **prod**: 실제 운영 트래픽 대응용 연결 풀 확장 (기존 대비 2-6배 증설)

### **3. JPA/Hibernate 설정**

#### **공통 설정**
```yaml
hibernate:
  ddl-auto: none                    # 모든 환경에서 DDL 자동 생성 비활성화
show-sql: true                      # 모든 환경에서 SQL 로그 활성화
format_sql: true                    # SQL 포매팅 활성화
use_sql_comments: true              # SQL 주석 활성화
```

#### **환경별 Dialect 설정**
| 환경 | Hibernate Dialect | 설명 |
|------|-------------------|------|
| **elocal/edev** | `PostgreSQLDialect` | PostgreSQL 최적화 |
| **local/dev/prod** | `OracleDialect` | Tibero(Oracle 호환) 최적화 |

---

## 📊 로깅 설정 비교 분석

### **1. 로그 레벨 매트릭스**

| 환경 | Root Level | Application Level | Spring Level | SQL Level | 특징 |
|------|------------|-------------------|--------------|-----------|------|
| **elocal** | `INFO` | `DEBUG` 🔍 | `DEBUG` | `DEBUG` | 개발 디버깅 |
| **edev** | `INFO` | `DEBUG` 🔍 | `INFO` | `DEBUG` | 외부개발 |
| **local** | `INFO` | `DEBUG` 🔍 | `DEBUG` | `DEBUG` | 개발 디버깅 |
| **dev** | `WARN` | `INFO` ⚖️ | `WARN` | `ERROR` | **성능테스트 최적화** |
| **prod** | `ERROR` | `INFO` ⚠️ | `ERROR` | `ERROR` | **운영 보안** |

### **2. 로그 출력 방식**

| 환경 | 콘솔 출력 | 파일 출력 | 형식 | 보관 정책 |
|------|-----------|-----------|------|----------|
| **elocal** | ✅ 활성화 | ❌ 비활성화 | 커스텀 패턴 | N/A |
| **edev** | ✅ 활성화 | ✅ 활성화 | 콘솔+JSON | 14일 |
| **local** | ✅ 활성화 | ❌ 비활성화 | 커스텀 패턴 | N/A |
| **dev** | ❌ 비활성화 | ✅ 활성화 | JSON 전용 | 30일 |
| **prod** | ❌ 비활성화 | ✅ 활성화 | JSON 전용 | 60일 |

---

## 🚀 외부 API 연동 설정 비교

### **1. SKTAI API 설정**

| 환경 | Base URL | 설명 |
|------|----------|------|
| **elocal/edev** | `https://adxp.mobigen.com` | 외부망 SKTAI |
| **local/dev** | `https://adxp.gapdev.shinhan.com` | 내부망 개발 |
| **prod** | `https://adxp.gap.shinhan.com` | 내부망 운영 |

### **2. Lablup API 설정**

| 환경 | Base URL | 액세스 키 | 설명 |
|------|----------|-----------|------|
| **elocal/edev** | `http://110.45.167.85:8091` | `AKIAYGKQTA7HHL4KCEQM` | 외부망 서버 |
| **local/dev** | `http://192.168.155.126:8081` | `2W8NDGSVPW4E0FXQWFQB` | 내부망 서버 |
| **prod** | `http://192.168.155.126:8081` | `AKIAYGKQTA7HHL4KCEQM` | 운영 서버 |

### **3. 기타 외부 시스템 URL 매핑**

#### **Elasticsearch**
| 환경 | URL | 설명 |
|------|-----|------|
| **elocal/edev** | `https://adxp-opensearch.mobigen.com` | 외부망 |
| **local/dev** | `https://opensearch.gapdev.shinhan.com` | 내부망 개발 |
| **prod** | `http://opensearch.gap.shinhan.com` | 내부망 운영 |

#### **Datumo**
| 환경 | URL | 설명 |
|------|-----|------|
| **elocal/edev** | `http://eval-public-shinhan.datumo.com` | 외부 공용 |
| **local/dev** | `http://datumo.gapdev.shinhan.com` | 내부망 개발 |
| **prod** | `http://datumo.gap.shinhan.com` | 내부망 운영 |

---

## 🔧 개발 도구 및 기능 설정

### **1. SpringDoc/Swagger UI 설정**

| 환경 | Swagger UI | API 문서 | 보안 설정 | 사용 목적 |
|------|------------|-----------|-----------|----------|
| **elocal** | ✅ `enabled: true` | ✅ 활성화 | 완화됨 | 개발/테스트 |
| **edev** | ✅ `enabled: true` | ✅ 활성화 | 완화됨 | 외부 개발 |
| **local** | ✅ `enabled: true` | ✅ 활성화 | 완화됨 | 개발/테스트 |
| **dev** | ✅ `enabled: true` | ✅ 활성화 | 완화됨 | 내부 개발/테스트 |
| **prod** | ❌ `enabled: false` | ❌ 비활성화 | **강화됨** | 운영 보안 |

### **2. 개발 도구 활성화 상태**

| 기능 | elocal | edev | local | dev | prod | 설명 |
|------|--------|------|-------|-----|------|------|
| **H2 Console** | ✅ | ❌ | ❌ | ❌ | ❌ | PostgreSQL 개발용만 |
| **DevTools** | ✅ | ❌ | ✅ | ❌ | ❌ | 로컬 개발용만 |
| **LiveReload** | ✅ | ❌ | ✅ | ❌ | ❌ | 로컬 개발용만 |
| **JMX** | ❌ | ❌ | ❌ | ❌ | ❌ | 모든 환경에서 비활성화 |

---

## 🛡️ 보안 및 SSL 설정

### **SSL 설정 정책**
```yaml
# 모든 환경 공통 SSL 설정 (개발 중심)
ssl:
  trust-all: true                   # SSL 인증서 검증 우회
  verify-hostname: false            # 호스트명 검증 우회
  enabled-protocols: TLSv1.2,TLSv1.3
```

### **외부 API 보안 설정**
| 시스템 | 인증 방식 | 보안 레벨 | 설명 |
|--------|-----------|-----------|------|
| **SKTAI** | OAuth2 + JWT | 높음 | 토큰 기반 인증 |
| **Lablup** | API Key + Secret | 중간 | 시그니처 기반 |
| **Elastic** | Basic Auth | 중간 | 사용자명/비밀번호 |
| **iONE** | API Gateway | 높음 | Gateway 기반 |

---

## ⚡ 성능 최적화 설정 비교

### **1. 데이터베이스 성능 설정**

#### **JDBC 배치 처리**
```yaml
# 모든 환경 공통
jdbc:
  batch_size: 25
  order_inserts: true
  order_updates: true
```

#### **환경별 커넥션 풀 성능 비교**

| 환경 | 동시 연결 | 처리량 | 응답시간 | 최적화 목표 |
|------|-----------|--------|----------|-------------|
| **elocal** | 낮음 (10) | 기본 | 느림 (30s) | 개발 편의성 |
| **edev** | 낮음 (10) | 기본 | 느림 (30s) | 개발 안정성 |
| **local** | 낮음 (10) | 기본 | 느림 (30s) | 개발 편의성 |
| **dev** | **높음 (40)** | **향상** | **빠름 (10s)** | **성능테스트 대응** |
| **prod** | **최고 (60)** | **최대** | **최적 (15s)** | **운영 트래픽 대응** |

### **2. Feign Client 성능 설정**

#### **타임아웃 설정 (공통)**
```yaml
feign:
  client:
    config:
      default:
        connect-timeout: 10000ms      # 연결 타임아웃
        read-timeout: 60000ms         # 읽기 타임아웃
      authClient:
        connect-timeout: 15000ms      # 인증 클라이언트 특별 설정
        read-timeout: 30000ms
```

#### **커넥션 풀 설정 (공통)**
```yaml
feign:
  httpclient:
    max-connections: 200              # 전체 최대 연결
    max-connections-per-route: 50     # 라우트당 최대 연결
    time-to-live: 900                 # 연결 유지 시간
```

---

## 🏷️ 애플리케이션 메타데이터

### **환경별 애플리케이션 정보**
| 환경 | App Name | Environment | 설명 |
|------|----------|-------------|------|
| **elocal** | `(Elocal)AX Portal Backend` | `elocal` | 외부Local 식별 |
| **edev** | `(Edev)AX Portal Backend` | `edev` | 외부개발 식별 |
| **local** | `(Local)AX Portal Backend` | `local` | 내부Local 식별 |
| **dev** | `(Dev)AX Portal Backend` | `dev` | 내부개발 식별 |
| **prod** | `AX Portal Backend` | `prod` | 운영환경 (접두사 없음) |

### **공통 메타데이터**
```yaml
app:
  version: 1.0.0
server:
  port: 8080
  servlet:
    context-path: /api
```

---

## 🔄 프로파일 활성화 전략

### **기본 프로파일 설정**
```yaml
spring:
  profiles:
    active: ${SPRING_PROFILES_ACTIVE:elocal}    # 기본값: elocal
```

### **환경 전환 방법**
```bash
# 개발 방법별 프로파일 설정
java -jar app.jar --spring.profiles.active=elocal    # 외부Local
java -jar app.jar --spring.profiles.active=local     # 내부Local  
java -jar app.jar --spring.profiles.active=edev      # 외부개발
java -jar app.jar --spring.profiles.active=dev       # 내부개발
java -jar app.jar --spring.profiles.active=prod      # 운영환경

# 환경변수 방식
export SPRING_PROFILES_ACTIVE=dev
java -jar app.jar
```

---

## 📈 모니터링 및 관리 설정

### **1. Actuator 엔드포인트 (공통)**
```yaml
management:
  endpoints:
    web:
      exposure:
        include: health,info,metrics,prometheus
  endpoint:
    health:
      show-details: always
```

### **2. 배치 작업 설정**

#### **IDE 삭제 배치**
```yaml
kube:
  ide:
    delete-batch-cron: "0 0 0 * * *"        # 매일 자정 실행
    delete-batch-startup: true               # 기동시 1회 실행
```

#### **HR 데이터 배치**
```yaml
batch:
  hr:
    cron: "0 0 0 * * ?"                      # 매일 00:00 실행
```

#### **사용자 사용량 관리 배치**
```yaml
userUsageMgmt:
  delete-batch-cron: "0 0 5 * * ?"          # 매일 05:00 실행
```

---

## 🚦 환경별 설정 권장사항

### **🟢 개발 환경 (elocal/local)**
- ✅ **DevTools 활용**: 자동 재시작, LiveReload 활용
- ✅ **디버그 로깅**: SQL, 파라미터 바인딩 로그 활성화
- ✅ **H2 Console**: PostgreSQL 개발시 활용 (elocal만)
- ⚠️ **보안 완화**: SSL 검증 우회 (개발 편의성)

### **🟡 개발 서버 (edev/dev)**
- ⚖️ **하이브리드 로깅**: 콘솔(edev) + 파일 로그 병행
- ⚡ **성능 최적화**: 커넥션 풀 확장 (dev)
- 📁 **로그 파일 관리**: JSON 형식, 로테이션 정책
- 🔍 **모니터링**: Actuator 엔드포인트 활용

### **🔴 운영 환경 (prod)**
- 🛡️ **보안 강화**: Swagger UI 비활성화
- 📊 **로그 최적화**: 파일 전용, ERROR/WARN 레벨
- 🚀 **성능 극대화**: 최대 커넥션 풀 (60개)
- 📈 **모니터링 강화**: Prometheus, 감사 로그

---

## 📋 설정 검증 체크리스트

### **환경 전환시 확인 사항**
- [ ] 데이터베이스 연결 정보 확인
- [ ] 외부 API URL 변경 확인  
- [ ] 로그 레벨 및 출력 방식 확인
- [ ] 보안 설정 (SSL, Swagger) 확인
- [ ] 성능 설정 (커넥션 풀) 확인
- [ ] 모니터링 도구 활성화 확인

### **운영 배포시 필수 체크**
- [ ] `spring.profiles.active=prod` 설정
- [ ] Swagger UI 비활성화 확인
- [ ] 로그 파일 권한 및 경로 확인
- [ ] 외부 API 운영 URL 확인
- [ ] 데이터베이스 커넥션 풀 최적화 확인
- [ ] SSL 인증서 및 보안 설정 확인

---

## 📊 요약 및 결론

### **환경별 특화 포인트**
1. **elocal**: PostgreSQL + H2 Console + DevTools (기본 개발환경)
2. **edev**: PostgreSQL + 하이브리드 로깅 (외부 개발서버)
3. **local**: Tibero + DevTools (내부 로컬 개발)
4. **dev**: Tibero + 성능최적화 + JSON 로깅 (성능테스트 환경)
5. **prod**: Tibero + 보안강화 + 다중 로그파일 (운영환경)

### **설정 관리 베스트 프랙티스**
- 🎯 **환경별 분리**: 명확한 프로파일 기반 설정 분리
- 🔧 **공통 설정**: application.yml에서 기본값 관리
- 🔒 **보안 고려**: 환경변수 기반 민감정보 관리
- 📊 **성능 최적화**: 환경 특성에 맞는 리소스 할당
- 🔍 **모니터링**: 환경별 로깅 및 메트릭 정책 차별화

이 설정 체계는 개발부터 운영까지의 전체 라이프사이클을 지원하며, 각 환경의 특성과 요구사항을 충족하도록 설계되었습니다. 🚀